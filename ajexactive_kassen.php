


    <!-- <div class="col-lg-3 col-md-6">
        <div class="card">
            <div class="card-header card-active">
                <div class="card-top-caption">
                    <div class="on-icon"></div>
                    <div class="k-no">12345</div>
                    <div class="star-icon"><i class="ti ti-star"></i></div>
                </div>
            </div>
            <div class="card-body">
                <div class="img-frame">
                   <img src="img/realTime/img1.jpg" alt="img" class="img-round">
                </div>
                <div class="card-bottom-caption">
                    <div class="left-icon"><span class="name-id">John Doe</span></div>
                    <div class="right-icon">
                       <i class="ti ti-map-pin"></i> <span>Abc, Street 2303, CA - 100223</span>
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <button type="button" class="btn btn-light bg-white main-id"><i class="ti ti-device-desktop"></i> 623 156 289</button>
                <button class="btn btn-light btn-sm bg-white chat-icon" type="button"><i class="ti ti-message-circle"></i></button>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6">
        <div class="card">
            <div class="card-header card-deactive">
                <div class="card-top-caption">
                    <div class="off-icon"></div>
                    <div class="k-no">12345</div>
                    <div class="star-icon"><i class="ti ti-star"></i></div>
                </div>
            </div>
            <div class="card-body">
                <div class="img-frame">
                   <img src="img/realTime/img1.jpg" alt="img" class="img-round">
                </div>
                <div class="card-bottom-caption">
                    <div class="left-icon"><span class="name-id">John Doe</span></div>
                    <div class="right-icon">
                       <i class="ti ti-map-pin"></i> <span>Abc, Street 2303, CA - 100223</span>
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <button type="button" class="btn btn-light bg-white main-id"><i class="ti ti-device-desktop"></i> 623 156 289</button>
                <button class="btn btn-light btn-sm bg-white chat-icon" type="button"><i class="ti ti-message-circle"></i></button>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6">
        <div class="card">
            <div class="card-header card-wechsel">
                <div class="card-top-caption">
                    <div class="wechsel-icon"></div>
                    <div class="k-no">12345</div>
                    <div class="star-icon"><i class="ti ti-star"></i></div>
                </div>
            </div>
            <div class="card-body">
                <div class="img-frame">
                   <img src="img/realTime/img1.jpg" alt="img" class="img-round">
                </div>
                <div class="card-bottom-caption">
                    <div class="left-icon"><span class="name-id">John Doe</span></div>
                    <div class="right-icon">
                       <i class="ti ti-map-pin"></i> <span>Abc, Street 2303, CA - 100223</span>
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <button type="button" class="btn btn-light bg-white main-id"><i class="ti ti-device-desktop"></i> 623 156 289</button>
                <button class="btn btn-light btn-sm bg-white chat-icon" type="button"><i class="ti ti-message-circle"></i></button>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6">
        <div class="card">
            <div class="card-header card-active">
                <div class="card-top-caption">
                    <div class="on-icon"></div>
                    <div class="k-no">12345</div>
                    <div class="star-icon"><i class="ti ti-star"></i></div>
                </div>
            </div>
            <div class="card-body">
                <div class="img-frame">
                   <img src="img/realTime/img1.jpg" alt="img" class="img-round">
                </div>
                <div class="card-bottom-caption">
                    <div class="left-icon"><span class="name-id">John Doe</span></div>
                    <div class="right-icon">
                       <i class="ti ti-map-pin"></i> <span>Abc, Street 2303, CA - 100223</span>
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <button type="button" class="btn btn-light bg-white main-id"><i class="ti ti-device-desktop"></i> 623 156 289</button>
                <button class="btn btn-light btn-sm bg-white chat-icon" type="button"><i class="ti ti-message-circle"></i></button>
            </div>
        </div>
    </div>

 -->


<style>
    button.btn.box {
    margin-right: 4px;
    border-radius: 50px;
    position: relative;
}
/*button.btn.box:hover .tooltip{height: 35px; width: 35px;} */

.icon-list {
    display: flex;
    justify-content: center;
    flex-direction: row;
    position: relative;
    top: -30px;
    left: 73%;
    padding: 0px;
    width: 30px;
    height: 30px;
    background-color: #f3be4a;
    align-items: center;
    border-radius: 50px;
}
.icon-list i {
    padding: 0px 5px;
    cursor: pointer;
}
.icon-list i.fa-solid.fa-utensils {
/*    display: flex;
    flex-direction: row;*/
    left: 4px;
    top: 8px;
    position: absolute;
}
.icon-list i.fa-solid.fa-desktop {
    left: 36px;
    position: absolute;
}
.myBox.div {
    background-color: #f0f0f0;
    position: absolute;
    top: -118px;
    width: 203px;
    padding: 10px;
    text-align: left;
}
textarea#w3review {
    width: 100%;
    border:1px solid #dfdfdf;
}
.myBox.div input[type="submit"] {
    background-color: #000;
    color: #fff;
    box-shadow: none;
    border: none;
    font-size: 13px;
    padding: 3px 14px;
    float: right;
}
.myBox.div i.fas.fa-times.close-icon {
    width: 20px;
    height: 20px;
    background-color: #000;
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 50px;
    position: absolute;
    top: -11px;
    right: 0px;
    cursor: pointer;
}
/* Tooltip box */
 button.btn.box::before {
  content: attr(data-tooltip); 
  position: absolute;
  width: 150px;
  background-color: #000;
  color: #fff;
  text-align: center;
  padding: 5px 5px 10px;
  line-height: 1.2;
  border-radius: 6px;
  z-index: 1;
  opacity: 0;
  transition: opacity .6s;
  bottom: 123%;
  left: 50px;
  margin-left: -60px;
  font-size: 0.85em;
  visibility: hidden;
}

/* Tooltip arrow */
 button.btn.box::after {
  content: "";
  position: absolute;
  bottom: 92%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  opacity: 0;
  transition: opacity .6s;
  border-color: #000 transparent transparent transparent;
  visibility: hidden;
}

 button.btn.box:hover::before,  button.btn.box:hover::after {
  opacity: 1;
  visibility: visible;
}

</style>

<?php 
include('db.php');
$where="";
$sortBy=" kassen_protokoll.id DESC ";
if(isset($_GET['searchby'])){
    if(!empty($_GET['searchby'])){
        $where=" AND ".$_GET['searchby']." LIKE '%".$_GET['searchvalue']."%'";
    }

}
if(isset($_GET['sortvalue'])){
    if(!empty($_GET['sortvalue'])){
        if($_GET['sortvalue']==1){
            $sortBy=" kassen_protokoll.status  DESC ";
        }else if($_GET['sortvalue']==2){
            $sortBy=" kassen_protokoll.status ASC";
        }else{
            $sortBy=" kassen_protokoll.id DESC "; 
           
        }
    }

}
    $empQuery = "select kassen_protokoll.*,restaurants.resttype,restaurants.restaurant_name,restaurants.restaurant_str,restaurants.restaurant_str_nr,restaurants.restaurant_plz,restaurants.restaurant_ort from kassen_protokoll LEFT JOIN restaurants ON restaurants.`restaurant_id`=kassen_protokoll.kundenNr  where kassen_protokoll.client_id!='' ".$where." GROUP by kassen_protokoll.id Order by ".$sortBy;
$empRecords = mysqli_query($conn, $empQuery);
$data = array();

while ($row = mysqli_fetch_assoc($empRecords)) {
    $address=$row["restaurant_str"]." ".$row["restaurant_str_nr"]."<br>".$row["restaurant_plz"]." ".$row["restaurant_ort"];
    
    $url="http://api.khanapos.de/storage/app/public/device_images/".$row['imageBase64'];
  $file_headers = get_headers($url);
    ?>


<div class="col-lg-3 col-md-6"> 
        <div class="card">
            <div class="card-header card-active">
                <div class="card-top-caption">
                <?php if($row['status']==1){?>
                    <div class="on-icon"></div>
                    <?php }else{?>
                        <div class="off-icon"></div>
                        <?php } ?>
                    <div class="k-no" id="kon-<?=$row['id']?>" style="cursor: pointer;"><?=$row['kundenNr']?></div>
                    <div class="star-icon"><i class="ti ti-star"></i></div>
                </div>
            </div>
            <div class="card-body">
                <div class="img-frame">
                <?php 
                if(!empty($row['imageBase64'])){
                    if($file_headers[0] == 'HTTP/1.1 404 Not Found') {
                    ?>
                    <img src="img/realTime/img1.jpg" alt="img" class="img-round">
            
                <?php }else{ ?>
                    <img src="<?=$url;?>" alt="img" class="img-round">
                    <?php } }else{ ?>
                    <img src="img/realTime/img1.jpg" alt="img" class="img-round">
                <?php }?>
                <div class="icon-list">
                <?php if($row['resttype']=='pc'){
                            echo '<i class="fa-solid fa-desktop"></i> <br>';
                    }elseif ($row['resttype']=='einzel'){
                        echo '<i class="fa-solid fa-bag-shopping"></i> <br>';
                    }else{
                        echo '<i class="fa-solid fa-utensils"></i> <br>';
                    }?>
                   
<!--                     <i class="fa-solid fa-desktop"></i><br>
                    <i class="fa-solid fa-utensils"></i> -->

                </div>
                </div> 
                <div class="card-bottom-caption">
                    <div class="left-icon"><span class="name-id" id="name-<?=$row['id']?>"><?=$row['restaurant_name']?></span></div>
                    <div class="right-icon">
                        <!-- <i class="fa-solid fa-desktop"></i> -->
<!--                         <i class="fa-solid fa-tablet"></i>
                        <i class="fa-solid fa-mobile"></i> -->
                       <i class="ti ti-map-pin"></i> <span id="address-<?=$row['id']?>"><?=$address?></span>
                    </div>
                </div>
            </div>
            <div class="card-footer">
            <button class="btn box clickevent tooltipupdate-<?=$row['id']?>" onClick="toggleDiv(<?=$row['id']?>)" <?php if(!empty($row['note'])){ ?> data-tooltip="<?=$row['note']?>" <?php } ?>data-rel="<?=$row['id']?>" type="button">2</button><br>
                <div class="myBox divshow<?=$row['id']?> div" style="display: none;">
                    <i class="fas fa-times close-icon" onClick="toggleDiv(<?=$row['id']?>)"></i>
                    <form action="javascript:void(0)">
                          
                          <textarea id="w3review" class="infotext-<?=$row['id']?>" name="w3review" rows="2" cols="50"><?=$row['note']?></textarea>
                          <br>
                          <input type="submit" value="Submit" class="btninfosave" data-rel="<?=$row['id']?>">
                        </form> 
                  <!-- <button class="btn btn-secondary" onClick="toggleDiv()">Close</button> -->
                </div>

                <p class="GFG_DOWN" style="color: green;"></p>
                               
                <button type="button" class="btn btn-light bg-white main-id clipboard"   data-ref="<?=$row['anydesk']?>" id="any-<?=$row['id']?>"> <?=$row['anydesk']?></button>
                <button class="btn btn-light btn-sm bg-white chat-icon openassing" data-kundennr="<?=$row['kundenNr']?>" data-rel="<?=$row['id']?>" type="button">
                <?php 
                if($row['kundenNr']==0){
                ?>
                <i class="ti ti-circle-plus"></i>
                <?php 
                    }else{?>
                        <i class="ti ti-edit"></i>
                        <?php
                    }?>
              
            </button>
            </div>
        </div>
    </div>
<!-- <div class="col-lg-3 col-md-6">
    <div class="card">
        <div class="card-body">
            <div class="card-top-caption">
                <?php if($row['status']==1){?>
                    <div class="on-icon"></div>
                    <?php }else{?>
                        <div class="off-icon"></div>
                        <?php } ?>
               
                <div class="star-icon"><i class="ti ti-star"></i></div>
            </div>
            <div class="img-frame">
                <?php 
                if(!empty($row['imageBase64'])){
                    if($file_headers[0] == 'HTTP/1.1 404 Not Found') {
                    ?>
                    <img src="img/realTime/img1.jpg" alt="img" class="img-round">
            
                <?php }else{ ?>
                    <img src="<?=$url;?>" alt="img" class="img-round">
                    <?php } }else{ ?>
                    <img src="img/realTime/img1.jpg" alt="img" class="img-round">
                <?php }?>
            </div>
            <div class="card-bottom-caption">
                <div class="left-icon"><i class="ti ti-device-desktop"></i> <span class="main-id"><?=$row['anydesk']?></span></div>
                <div class="right-icon">
                    <i class="ti ti-map-pin"></i> <span><?=$address?></span>
                </div>
            </div>
        </div>
    </div>
</div> -->


<script>
function toggleDiv(showid) {
  var myBox = $('.divshow'+showid);
  myBox.toggle();
  if (myBox.is(':visible')) {
    $('.GFG_DOWN');
  } else {
    $('.GFG_DOWN');
  }
}
</script>


<?php } ?>
